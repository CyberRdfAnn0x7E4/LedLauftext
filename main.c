#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define LEFT_TO_RIGHT 1
#define RIGHT_TO_LEFT 2
#define TOP_TO_BOTTOM 4
#define BOTTOM_TO_TOP 8

void generateOutputBuffer(const unsigned char font5x7int[], unsigned char output[][5][7], unsigned char input[], unsigned int sizeInput);
void printOutput(unsigned char output[][5][7], unsigned char input[], unsigned char mode, unsigned int maxColumns, unsigned int maxRows, unsigned int sizeInput);

int main()
{
	//Quelle: http://www.noritake-itron.com/
	const unsigned char font5x7int[]={ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF2, 0x00, 0x00, 0x00, 0xE0, 0x00, 0xE0, 0x00, 0x28, 0xFE, 0x28, 0xFE, 0x28, 0x24, 0x54, 0xFE, 0x54, 0x48, 0xC4, 0xC8, 0x10, 0x26, 0x46, 0x6C, 0x92, 0xAA, 0x44, 0x0A, 0x00, 0xA0, 0xC0, 0x00, 0x00, 0x00, 0x38, 0x44, 0x82, 0x00, 0x00, 0x82, 0x44, 0x38, 0x00, 0x28, 0x10, 0x7C, 0x10, 0x28, 0x10, 0x10, 0x7C, 0x10, 0x10, 0x00, 0x0A, 0x0C, 0x00, 0x00, 0x10, 0x10, 0x10, 0x10, 0x10, 0x00, 0x06, 0x06, 0x00, 0x00, 0x04, 0x08, 0x10, 0x20, 0x40, 0x7C, 0x8A, 0x92, 0xA2, 0x7C, 0x00, 0x42, 0xFE, 0x02, 0x00, 0x42, 0x86, 0x8A, 0x92, 0x62, 0x84, 0x82, 0xA2, 0xD2, 0x8C, 0x18, 0x28, 0x48, 0xFE, 0x08, 0xE4, 0xA2, 0xA2, 0xA2, 0x9C, 0x3C, 0x52, 0x92, 0x92, 0x0C, 0x80, 0x8E, 0x90, 0xA0, 0xC0, 0x6C, 0x92, 0x92, 0x92, 0x6C, 0x60, 0x92, 0x92, 0x94, 0x78, 0x00, 0x6C, 0x6C, 0x00, 0x00, 0x00, 0x6A, 0x6C, 0x00, 0x00, 0x10, 0x28, 0x44, 0x82, 0x00, 0x28, 0x28, 0x28, 0x28, 0x28, 0x00, 0x82, 0x44, 0x28, 0x10, 0x40, 0x80, 0x8A, 0x90, 0x60, 0x4C, 0x92, 0x9E, 0x82, 0x7C, 0x7E, 0x88, 0x88, 0x88, 0x7E, 0xFE, 0x92, 0x92, 0x92, 0x6C, 0x7C, 0x82, 0x82, 0x82, 0x44, 0xFE, 0x82, 0x82, 0x44, 0x38, 0xFE, 0x92, 0x92, 0x92, 0x82, 0xFE, 0x90, 0x90, 0x90, 0x80, 0x7C, 0x82, 0x92, 0x92, 0x5E, 0xFE, 0x10, 0x10, 0x10, 0xFE, 0x00, 0x82, 0xFE, 0x82, 0x00, 0x04, 0x02, 0x82, 0xFC, 0x80, 0xFE, 0x10, 0x28, 0x44, 0x82, 0xFE, 0x02, 0x02, 0x02, 0x02, 0xFE, 0x40, 0x30, 0x40, 0xFE, 0xFE, 0x20, 0x10, 0x08, 0xFE, 0x7C, 0x82, 0x82, 0x82, 0x7C, 0xFE, 0x90, 0x90, 0x90, 0x60, 0x7C, 0x82, 0x8A, 0x84, 0x7A, 0xFE, 0x90, 0x98, 0x94, 0x62, 0x62, 0x92, 0x92, 0x92, 0x8C, 0x80, 0x80, 0xFE, 0x80, 0x80, 0xFC, 0x02, 0x02, 0x02, 0xFC, 0xF8, 0x04, 0x02, 0x04, 0xF8, 0xFC, 0x02, 0x0C, 0x02, 0xFC, 0xC6, 0x28, 0x10, 0x28, 0xC6, 0xE0, 0x10, 0x0E, 0x10, 0xE0, 0x86, 0x8A, 0x92, 0xA2, 0xC2, 0x00, 0xFE, 0x82, 0x82, 0x00, 0x40, 0x20, 0x10, 0x08, 0x04, 0x00, 0x82, 0x82, 0xFE, 0x00, 0x20, 0x40, 0x80, 0x40, 0x20, 0x02, 0x02, 0x02, 0x02, 0x02, 0x00, 0x80, 0x40, 0x20, 0x00, 0x04, 0x2A, 0x2A, 0x2A, 0x1E, 0xFE, 0x12, 0x12, 0x12, 0x0C, 0x1C, 0x22, 0x22, 0x22, 0x22, 0x0C, 0x12, 0x12, 0x12, 0xFE, 0x1C, 0x2A, 0x2A, 0x2A, 0x1A, 0x00, 0x10, 0x7E, 0x90, 0x40, 0x12, 0x2A, 0x2A, 0x2A, 0x3C, 0xFE, 0x10, 0x10, 0x10, 0x0E, 0x00, 0x00, 0x5E, 0x00, 0x00, 0x04, 0x02, 0x02, 0xBC, 0x00, 0x00, 0xFE, 0x08, 0x14, 0x22, 0x00, 0x82, 0xFE, 0x02, 0x00, 0x3E, 0x20, 0x1C, 0x20, 0x3E, 0x3E, 0x10, 0x20, 0x20, 0x1E, 0x1C, 0x22, 0x22, 0x22, 0x1C, 0x3E, 0x28, 0x28, 0x28, 0x10, 0x10, 0x28, 0x28, 0x28, 0x3E, 0x3E, 0x10, 0x20, 0x20, 0x10, 0x12, 0x2A, 0x2A, 0x2A, 0x24, 0x20, 0x20, 0xFC, 0x22, 0x24, 0x3C, 0x02, 0x02, 0x02, 0x3C, 0x38, 0x04, 0x02, 0x04, 0x38, 0x3C, 0x02, 0x0C, 0x02, 0x3C, 0x22, 0x14, 0x08, 0x14, 0x22, 0x20, 0x12, 0x0C, 0x10, 0x20, 0x22, 0x26, 0x2A, 0x32, 0x22, 0x00, 0x10, 0x6C, 0x82, 0x82, 0x00, 0x00, 0xEE, 0x00, 0x00, 0x82, 0x82, 0x6C, 0x10, 0x00, 0x20, 0x40, 0x40, 0x40, 0x80, 0xA8, 0x68, 0x3E, 0x68, 0xA8, 0xBE, 0x2A, 0x2A, 0x2A, 0xA2, 0x00, 0x20, 0x50, 0xA0, 0x00, 0x04, 0x22, 0x7C, 0xA0, 0x40, 0x84, 0xFC, 0x04, 0x00, 0x20, 0xFE, 0x02, 0x02, 0x12, 0x02, 0x1C, 0x22, 0x14, 0x08, 0x36, 0x4E, 0x3E, 0x60, 0x40, 0x40, 0x0C, 0x12, 0x52, 0xB2, 0x1C, 0x08, 0x1C, 0x2A, 0x2A, 0x2A, 0xF8, 0x40, 0x40, 0x3C, 0x02, 0x7C, 0x92, 0x92, 0x7C, 0x00, 0x42, 0x44, 0x38, 0x04, 0x02, 0x20, 0x3E, 0x20, 0x3E, 0x22, 0x10, 0x20, 0x3C, 0x22, 0x20, 0x18, 0x24, 0x7E, 0x24, 0x18, 0x1C, 0x22, 0x0C, 0x22, 0x1C, 0x82, 0xC6, 0xAA, 0x92, 0x82, 0x3A, 0x46, 0x40, 0x46, 0x3A, 0x54, 0x54, 0x54, 0x54, 0x54, 0x44, 0x28, 0x10, 0x28, 0x44, 0x10, 0x10, 0x54, 0x10, 0x10, 0x00, 0x70, 0x88, 0x88, 0x70, 0x60, 0x90, 0x8A, 0x80, 0x40, 0xFE, 0xFE, 0x92, 0x92, 0x92, 0x0A, 0x1A, 0x2A, 0x4A, 0x8A, 0x8A, 0x4A, 0x2A, 0x1A, 0x0A, 0x28, 0x2C, 0x38, 0x68, 0x28, 0x04, 0xFE, 0x80, 0x80, 0x80, 0x4C, 0x92, 0x92, 0x7C, 0x00, 0x04, 0x02, 0x7C, 0x80, 0x40, 0x38, 0x44, 0x38, 0x44, 0x38, 0xAA, 0x54, 0xAA, 0x54, 0xAA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xBE, 0x00, 0x00, 0x38, 0x44, 0xFE, 0x44, 0x00, 0x12, 0x7E, 0x92, 0x92, 0x42, 0xBA, 0x44, 0x44, 0x44, 0xBA, 0xA8, 0x68, 0x3E, 0x68, 0xA8, 0x00, 0x00, 0xEE, 0x00, 0x00, 0x50, 0xAA, 0xAA, 0xAA, 0x14, 0x00, 0x80, 0x00, 0x80, 0x00, 0x7C, 0xBA, 0xAA, 0xAA, 0x7C, 0x12, 0xAA, 0xAA, 0xAA, 0x7A, 0x10, 0x28, 0x54, 0xAA, 0x44, 0x80, 0x80, 0x80, 0x80, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7C, 0xAA, 0xBA, 0x82, 0x7C, 0x80, 0x80, 0x80, 0x80, 0x80, 0x00, 0xE0, 0xA0, 0xE0, 0x00, 0x22, 0x22, 0xFA, 0x22, 0x22, 0x00, 0x48, 0x98, 0xA8, 0x48, 0x00, 0x00, 0xA8, 0xA8, 0x70, 0x00, 0x00, 0x40, 0x80, 0x00, 0x04, 0xF8, 0x10, 0x10, 0xE0, 0x60, 0xFE, 0x80, 0xFE, 0x80, 0x00, 0x00, 0x10, 0x10, 0x00, 0x08, 0x00, 0x02, 0x04, 0x00, 0x00, 0x48, 0xF8, 0x08, 0x00, 0x00, 0xE8, 0xA8, 0xE8, 0x00, 0x44, 0xAA, 0x54, 0x28, 0x10, 0xF0, 0x04, 0x0C, 0x14, 0x2E, 0xF0, 0x00, 0x12, 0x26, 0x1A, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE, 0x0C, 0x12, 0xA2, 0x02, 0x04, 0x1E, 0xA8, 0x68, 0x28, 0x1E, 0x1E, 0x28, 0x68, 0xA8, 0x1E, 0x1E, 0xA8, 0xA8, 0xA8, 0x1E, 0x9E, 0xA8, 0xA8, 0xA8, 0x9E, 0x9E, 0x28, 0x28, 0x28, 0x9E, 0x1E, 0x68, 0xA8, 0x68, 0x1E, 0x7E, 0x90, 0xFE, 0x92, 0x92, 0x70, 0x8A, 0x8C, 0x88, 0x88, 0x3E, 0xAA, 0x6A, 0x2A, 0x22, 0x3E, 0x2A, 0x6A, 0xAA, 0x22, 0x3E, 0xAA, 0xAA, 0xAA, 0x22, 0xBE, 0x2A, 0x2A, 0x2A, 0xA2, 0x00, 0xA2, 0x7E, 0x22, 0x00, 0x00, 0x22, 0x7E, 0xA2, 0x00, 0x00, 0xA2, 0xBE, 0xA2, 0x00, 0x00, 0xA2, 0x3E, 0xA2, 0x00, 0x10, 0xFE, 0x92, 0x82, 0x7C, 0xBE, 0x90, 0x88, 0x84, 0xBE, 0x1C, 0xA2, 0x62, 0x22, 0x1C, 0x1C, 0x22, 0x62, 0xA2, 0x1C, 0x1C, 0xA2, 0xA2, 0xA2, 0x1C, 0x9C, 0xA2, 0xA2, 0xA2, 0x9C, 0x9C, 0x22, 0x22, 0x22, 0x9C, 0x44, 0x28, 0x10, 0x28, 0x44, 0x3A, 0x4C, 0x54, 0x64, 0xB8, 0x3C, 0x82, 0x42, 0x02, 0x3C, 0x3C, 0x02, 0x42, 0x82, 0x3C, 0x3C, 0x82, 0x82, 0x82, 0x3C, 0xBC, 0x02, 0x02, 0x02, 0xBC, 0x60, 0x10, 0x4E, 0x90, 0x60, 0xFE, 0x44, 0x44, 0x44, 0x38, 0x7E, 0xA4, 0xA4, 0x58, 0x00, 0x04, 0xAA, 0x6A, 0x2A, 0x1E, 0x04, 0x2A, 0x6A, 0xAA, 0x1E, 0x04, 0xAA, 0xAA, 0xAA, 0x1E, 0x84, 0xAA, 0xAA, 0xAA, 0x9E, 0x04, 0xAA, 0x2A, 0xAA, 0x1E, 0x04, 0x6A, 0xAA, 0x6A, 0x1E, 0x2E, 0x2A, 0x1C, 0x2A, 0x3A, 0x30, 0x4A, 0x4C, 0x48, 0x00, 0x1C, 0xAA, 0x6A, 0x2A, 0x1A, 0x1C, 0x2A, 0x6A, 0xAA, 0x1A, 0x1C, 0xAA, 0xAA, 0xAA, 0x1A, 0x1C, 0xAA, 0x2A, 0xAA, 0x1A, 0x00, 0x80, 0x5E, 0x00, 0x00, 0x00, 0x00, 0x5E, 0x80, 0x00, 0x00, 0x40, 0x5E, 0x40, 0x00, 0x00, 0x40, 0x1E, 0x40, 0x00, 0x0C, 0x12, 0x52, 0xB2, 0x1C, 0xBE, 0x90, 0xA0, 0xA0, 0x9E, 0x0C, 0x92, 0x52, 0x12, 0x0C, 0x0C, 0x12, 0x52, 0x92, 0x0C, 0x0C, 0x52, 0x52, 0x52, 0x0C, 0x4C, 0x52, 0x52, 0x52, 0x4C, 0x0C, 0x52, 0x12, 0x52, 0x0C, 0x10, 0x10, 0x10, 0x54, 0x10, 0x18, 0x26, 0x3C, 0x64, 0x18, 0x1C, 0x82, 0x42, 0x02, 0x1C, 0x1C, 0x02, 0x42, 0x82, 0x1C, 0x1C, 0x42, 0x42, 0x42, 0x1C, 0x1C, 0x42, 0x02, 0x42, 0x1C, 0x20, 0x12, 0x4C, 0x90, 0x20, 0xFE, 0x48, 0x48, 0x30, 0x00, 0x20, 0x92, 0x0C, 0x90, 0x20};
	unsigned char mode;

	//settings:
	unsigned char input[] = "Guten Tag!";
	unsigned int
			maxColumns = 50,
			maxRows = 14;

	//poosible modes:
//	mode = LEFT_TO_RIGHT;
//	mode = RIGHT_TO_LEFT;
//	mode = TOP_TO_BOTTOM;
//	mode = BOTTOM_TO_TOP;
//	mode = LEFT_TO_RIGHT | TOP_TO_BOTTOM;
//	mode = LEFT_TO_RIGHT | BOTTOM_TO_TOP;
	mode = RIGHT_TO_LEFT | TOP_TO_BOTTOM;
//	mode = RIGHT_TO_LEFT | BOTTOM_TO_TOP;

	unsigned int sizeInput = sizeof(input) / sizeof(char);
	unsigned char output[sizeInput][5][7];

	generateOutputBuffer(font5x7int, output, input, sizeInput);
	printOutput(output, input, mode, maxColumns, maxRows, sizeInput);

	return 0;
}

void generateOutputBuffer(const unsigned char font5x7int[], unsigned char output[][5][7], unsigned char input[], unsigned int sizeInput){

	unsigned char binary, x, y;
	unsigned int character, k, index;
	for(character = 0; character < sizeInput; character++){
		k = 0;
		for(x = 0; x < 5; x++, k++){
			binary = 128;
			for(y = 0; y < 7; y++, binary >>=1){
				index = ((unsigned int)input[character] *5) + k;
				output[character][x][y] = (font5x7int[index] & binary) == binary;
			}
		}
	}
}

void printOutput(unsigned char output[][5][7], unsigned char input[], unsigned char mode, unsigned int maxColumns, unsigned int maxRows, unsigned int sizeInput){

	int lastChar, lastX, lastY, x, y;
	unsigned int column = 0, row = 0 , character = 0;
	lastChar = lastX = lastY = 0;

	while(!kbhit()){
		row = 0;
		for(y = lastY; row < maxRows; y++, row++){

			if(y == 7){
				y = 0;
				printf("\n");
			}
			column = 0;

			for(character = (int)lastChar; column < maxColumns; character++){

				if(character == sizeInput){
					character = 0;
				}

				for(x = ((character == lastChar && column < 5) ? lastX : 0); x < 5 && column < maxColumns; x++){
					printf("%c", output[character][x][y] == 1 ? '#' : ' ');
					column++;
				}

				if(column < maxColumns){
					printf(" ");
					column++;
				}
			}
			printf("\n");
		}

		if((mode & RIGHT_TO_LEFT) == RIGHT_TO_LEFT){
			lastX++;
			if(lastX >= 5){
				lastX = 0;
				lastChar++;
				if(lastChar == sizeInput)
					lastChar = 0;
			}
		}
		else if((mode & LEFT_TO_RIGHT) == LEFT_TO_RIGHT){
			lastX--;
			if(lastX < 0){
				lastX = 4;
				lastChar--;
				if(lastChar < 0)
					lastChar = (int)sizeInput - 1;
			}
		}
		if((mode & TOP_TO_BOTTOM) == TOP_TO_BOTTOM){
			lastY--;
			if(lastY < 0){
				lastY = 6;
			}
		}
		else if((mode & BOTTOM_TO_TOP) ==BOTTOM_TO_TOP){
			lastY++;
			if(lastY > 6){
				lastY = 0;
			}
		}

		Sleep(150);
		system("cls");
	}
}
